<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>hzzy love to rh</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no" />
    <link rel="icon" href="./love.ico">
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./animate.css">
    <script src="./axios.min.js"></script>
</head>

<body>

    <div class="envlope-wrapper">
        <div id="envelope" class="close">
            <div class="front flap"></div>
            <div class="front pocket"></div>
            <div class="letter">
                <div class="words line1"></div>
                <div class="words line2"></div>
                <div class="words line3"></div>
                <div class="words line4"></div>
            </div>
            <div class="hearts">
                <div class="heart a1"></div>
                <div class="heart a2"></div>
                <div class="heart a3"></div>
            </div>
        </div>
        <div class="wrap_books removesDispaly">
            <div class="wrap_books_child">
                <div class="removes" title="关闭"></div>
                <div class="scrollable-div">
                    <h3>To:鹿姐</h3>
                    <hr>
                    <p>展信佳 </p>
                    <p>时方十二月</p>
                    <p>上河入冬</p>
                    <p>闲坐车内，感叹时光荏苒。</p>
                    <p>提笔落墨，思至黯然，</p>
                    <p>我自知才疏学浅，</p>
                    <p>又无气宇轩昂之容颜，</p>
                    <p>何德何能让姑娘为我停留驻足不前呢。</p>

                    <hr>
                    <p>但望姑娘顾怜，阅吾书函</p>
                    <p>近日，余恒自省。</p>
                    <p>从第一日晚上不欢而散始，</p>
                    <p>到第二日晚你电话里的言辞。</p>

                    <p>而反观我自己的反应和回答，</p>
                    <p>面皮薄，稚气未脱。</p>
                    <p>接不住你的意见，</p>
                    <p>敏感且容易过度解读你的意思，</p>
                    <p>实甚幼稚，毫无担当，</p>
                    <p>完全不应该是我这个年纪该有的反应，</p>
                    <p>自觉如巨婴焉。</p>

                    <p>静心思之，我也明白你的担忧，</p>
                    <p>且能感受到你缺乏安全感。</p>
                    <p>无论物质与精神，</p>
                    <p>我好像从未给过你足够的安全感。</p>

                    <p>不否认目前，目前物质上是硬伤</p>
                    <p>我无法保证给你锦衣玉食、无忧无虑的生活，</p>
                    <p>但我可以保证 有我刘灿在 ，</p>
                    <p>不会冻着饿着你丝毫，</p>
                    <p>也绝不会让你去沾阳春水。</p>
                    <p>纵天塌，只要余未死，</p>
                    <p>这天我拼了命也会给你顶着。</p>

                    <p>虽然当前很多事情，</p>
                    <p>不管是对你的关爱和照顾、</p>
                    <p>操持家务、个人穿搭等，</p>
                    <p>我做的确实不尽如人意，</p>
                    <p>然此亦示余尚能进，</p>
                    <p>那也说明我还能进步 能变得更好。</p>

                    <p>以前我一直觉得用自己的方式，</p>
                    <p>对一人好即可，</p>
                    <p>但是我好像慢慢明白，</p>
                    <p>似乎应该用对方的方式去爱对方 。</p>

                    <p>双鱼是个浪漫的星座，</p>
                    <p>而金牛却是个极端。</p>
                    <p>星座不是我的挡箭牌，</p>
                    <p>我不确定我能否做到 ，</p>
                    <p>但我想变成一个浪漫的人，</p>
                    <p>一个为你而浪漫的人。</p>

                    <p>姑娘啊</p>
                    <p>你可曾知，我数次提笔恐词不达意成笑谈，</p>
                    <p>更恐姑娘厌烦，</p>
                    <p>只能将心事藏于心间，</p>
                    <p>唐突之处，望姑娘海涵，</p>
                    <p>提笔是诗，落笔是念，</p>
                    <p>思也三千，念也三千，</p>
                    <p>浅浅文字，字字真言，</p>
                    <p>念你如初，思你如故，</p>
                    <p>人间苦漫，唯愿平安。</p>
                    <h3>From: LC</h3>
                </div>
                <div class="love_wrap">
                    <img id="agree" class="animate__animated animate__heartBeat animate__infinite"
                        src="./love.svg" alt="">
                    <img id="cancel" src="./xinsui.svg" alt="">
                </div>
            </div>
        </div>
    </div>

    <script>
        var envelope = document.getElementById('envelope')
        var clickOpen = document.getElementById('open')
        var clickClose = document.getElementById('reset')
        var agree = document.getElementById('agree')
        var cancel = document.getElementById('cancel')
        envelope.onclick = function () {
            open()
            setTimeout(() => {
                    document.querySelector('.wrap_books').classList.remove('removesDispaly')
                }, 2000)
            // if (localStorage.getItem('isok') == 'false' || localStorage.getItem('isok') == 'true') {
            //     if (localStorage.getItem('isok') == 'false') {
            //         hint('原谅我吧，我会努力的~')
            //     } else {
            //         hint('主人已经收到了您的爱意~')
            //     }
            // } else {
                
            // }
        }
        function open() {
            envelope.classList.add("open")
            envelope.classList.remove("close");
        }
        function close() {
            envelope.classList.add("close")
            envelope.classList.remove("open");
        }

        // 关闭按钮
        var closep = document.querySelector('.removes')
        closep.onclick = function () {
            document.querySelector('.wrap_books').classList.add('removesDispaly')
            close()
            closefireworks()
        }

        // 封装发送ajax请求
        function request(type, email) {
            return new Promise((resolve, reject) => {
                axios({
                    method: 'get',//提交方法
                    url: 'http://124.223.198.104:3123/api/smsemail',//提交地址
                    params: {
                        type,
                        email
                    }
                }).then(res => {
                    resolve(res)
                }).catch(err => {
                    reject(err)
                })
            })
        }
        // 点击爱心发送请求
        agree.onclick = function () {
            console.log('爱心发送~接受爱意');
            let type = 0
            // 开始放烟花
            fireworks()
            hint('对方已经收到你的心意~')
        }
        cancel.onclick = function () {
            hint('原谅我吧，我会努力的~')
            localStorage.setItem('isok', false)
            document.querySelector('.love_wrap').remove()
            document.querySelector('.wrap_books').classList.add('removesDispaly')
            close()
        }

        // 提示框封装
        function hint(txt) {
            let hintbox = document.createElement('div')
            hintbox.style.width = '220px'
            hintbox.style.color = '#999'
            hintbox.style.height = '50px'
            hintbox.style.background = '#fff'
            hintbox.style.boxShadow = '10px 20px 30px rgba(0,0,0,0.13)'
            hintbox.style.textAlign = 'center'
            hintbox.style.lineHeight = '50px'
            hintbox.style.position = 'relative'
            hintbox.style.top = '0'
            hintbox.style.left = '0'
            hintbox.style.right = '0'
            hintbox.style.bottom = '0'
            hintbox.style.margin = 'auto'
            // hintbox.style.marginLeft = '-150px'
            hintbox.style.zIndex = '9999'
            hintbox.innerHTML = txt
            hintbox.style.borderRadius = '10px'
            document.body.appendChild(hintbox)
            setTimeout(() => {
                hintbox.remove()
            }, 1500)
        }
    </script>

    <!-- 烟花效果 ---------------------------------------------  ************************************************* -->
    <script>
        const list = ["red", "yellow", "green", "blue", "orange", "black",
            "LightPink", "Magenta", "DarkSlateBlue", "MediumBlue", "DoderBlue",
            "PaleGodenrod", "Salmon", "IndianRed", "Maroon", "DimGray",
            "OrangeRed", "LightSalmon", "Chocolate", "DarkGreen", "Lime",
            "Gold", "Magenta", "LawnGreen", "MediumBlue", "RoyalBlue",
            "PaleGreen", "SeaGreen", "Turquoise", "DarkTurquoise", "DeepSkyBlue",
            "Aqua", "LightGoldenrodYellow"]; //颜色

        var Number = 30 //数量  太大会奔溃
        var magnitude = 200 //绽放大小范围 PX
        const size = [10, 15] //小球大小范围 PX
        const velocity = 1;  //停留时间  S
        var timeli = 0.5;  //烟花发射速度 S
        var sotp = false  //停止烟花
        var timeList; //计时器
        function method(x, y, e) {
            const box = document.createElement("div");
            box.className = 'div'
            box.id = 'item' + e
            box.style.left = x + "px";
            box.style.top = y + "px";
            box.style.width = magnitude + "px"
            box.style.height = magnitude + "px"
            document.querySelector('.wrap_books').appendChild(box);
            const div = document.getElementById(`item${e}`)
            for (let i = 0; i < Number; i++) {
                const index = Math.floor(Math.random() * list.length);
                const a = Math.floor(Math.random() * (size[0] - size[1])) + size[1]
                const color = list[index];
                const bondsman = document.createElement("span");
                bondsman.classList.add("bondsman");
                bondsman.style.background = color;
                bondsman.style.left = '50%';
                bondsman.style.top = '50%';
                bondsman.style.width = a + 'px';
                bondsman.style.height = a + 'px';
                bondsman.style.transition = velocity + 's';
                bondsman.style.opacity = 0
                div.appendChild(bondsman);
            }
            const time = velocity * 1000
            const span = div.getElementsByClassName("bondsman");
            setTimeout(() => {
                for (let i = 0; i < span.length; i++) {
                    if (Math.round(Math.random())) {
                        span[i].style.left = Math.floor(Math.random() * (100 - 0)) + 0 + '%'
                        span[i].style.top = Math.floor(Math.random() * (100 - 0)) + 0 + '%'
                        span[i].style.opacity = 1
                    } else {
                        span[i].style.left = Math.floor(Math.random() * (100 - 0)) + 0 + '%'
                        span[i].style.top = Math.floor(Math.random() * (100 - 0)) + 0 + '%'
                        span[i].style.opacity = 1
                    }
                    setTimeout(() => {
                        span[i].style.opacity = 0;
                    }, time / 2)
                }
            }, 100)

            setTimeout(() => {
                document.querySelector('.wrap_books').removeChild(div)
            }, time + 100)
        }
        function wire(e) {
            return new Promise((resolve) => {
                const box = document.createElement("div");
                box.className = 'span'
                box.id = 'index' + e
                box.style.left = Math.floor(Math.random() * (90 - 10)) + 10 + '%'
                box.style.top = '100%'
                box.style.transition = velocity + 's'
                box.opacity = 0;
                document.querySelector('.wrap_books').appendChild(box);
                const span = document.getElementById(`index${e}`)
                setTimeout(() => {
                    span.style.top = Math.floor(Math.random() * (50 - 15)) + 15 + '%'
                }, 200)
                setTimeout(() => {
                    span.opacity = 1;
                }, 300)
                setTimeout(() => {
                    let data = {
                        span: span, e: e
                    }
                    resolve(data)
                }, velocity * 1000 + 100)
            })
        }

        function fireworks() {
            I = 0
            timeList = setInterval(() => {
                wire(I++).then((data) => {
                    method(data.span.offsetLeft, data.span.offsetTop, data.e)
                    setTimeout(() => {
                        document.querySelector('.wrap_books').removeChild(data.span)
                    }, 100)
                })
            }, timeli * 1000)
        }

        function closefireworks() {
            clearInterval(timeList)
            stop = false
        }
    </script>

    </div>
</body>

</html>
